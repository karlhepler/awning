# ==============================================================================
# Bond Bridge Configuration
# ==============================================================================

# Get BOND_TOKEN from Bond Home app → Settings → Advanced Settings
BOND_TOKEN=your_bond_token_here

# ==============================================================================
# IMPORTANT: Bond Bridge IP Address
# ==============================================================================
# Your Bond Bridge requires a stable IP address. We STRONGLY recommend setting
# up a DHCP reservation in your router. This is best practice for ALL IoT
# devices - it ensures the IP never changes even after router reboots.
#
# How to set up a DHCP reservation:
# 1. Find your Bond Bridge's MAC address in Bond Home app → Settings
# 2. Log into your router's admin panel (usually 192.168.1.1 or 192.168.0.1)
# 3. Look for "DHCP Reservation", "Static DHCP", or "Address Reservation"
# 4. Create a reservation binding the Bond's MAC address to a fixed IP
#
# To find your Bond Bridge's current IP:
# - Check your router's connected devices list, or
# - Use the Bond Home app → Settings → Device Info
# ==============================================================================
BOND_HOST=192.168.1.XXX

# Device ID for your awning
# Find in Bond Home app → Select Device → Settings → Advanced
DEVICE_ID=your_device_id_here

# ==============================================================================
# Weather Automation Configuration
# ==============================================================================
# The automation opens the awning ONLY if ALL 7 conditions are met:
#   1. ✓ Sunny (direct normal irradiance at or above threshold)
#   2. ✓ Calm (wind speed below threshold)
#   3. ✓ No rain (precipitation = 0 mm/h)
#   4. ✓ Above freezing (temperature > 32°F)
#   5. ✓ Daytime (current time between sunrise and sunset)
#   6. ✓ Sun high enough (altitude above threshold, accounts for trees)
#   7. ✓ Sun facing SE (sun azimuth 90°-180° for southeast-facing window)
#
# If ANY condition fails, the awning will close.
# ==============================================================================

# Location - Used for weather data AND sun position calculation
# Find your coordinates at https://www.latlong.net/ or Google Maps (right-click → coordinates)
LATITUDE=37.7749
LONGITUDE=-122.4194

# Minimum direct normal irradiance (W/m²) - Controls "Sunny" condition
# Awning opens only if DNI is AT OR ABOVE this threshold
# DNI measures direct sunlight hitting a surface perpendicular to the sun
# Typical values:
#   0-200 W/m²: Thick clouds or overcast
#   200-400 W/m²: Moderate clouds or haze
#   400-700 W/m²: Thin clouds (cirrus) or light haze
#   700-1000 W/m²: Clear sky
# Default 300 W/m² opens for clear sky and thin high clouds, closes for thick clouds
MIN_DIRECT_IRRADIANCE_WM2=300

# Minimum sun altitude (degrees above horizon) - Controls "Sun high enough" condition
# Accounts for trees or obstacles that may block low sun
# 0° = on horizon, 90° = directly overhead
# Typical value: 10-20° depending on your landscape
MIN_SUN_ALTITUDE_DEG=10

# Wind speed threshold (mph) - Controls "Calm" condition
# Awning opens if wind speed is BELOW this speed
# IMPORTANT: Set conservatively below your awning's built-in wind sensor (typically 30 mph)
# Typical values: 8-12 mph (10 mph is a safe default for most residential awnings)
WIND_SPEED_THRESHOLD_MPH=10

# Hardcoded conditions (cannot be configured):
# - Rain: Any precipitation closes awning (0 mm/h threshold)
# - Freezing: Temperature must be > 32°F
# - Daytime: Automatically determined from sunrise/sunset
# - Sun position: Azimuth 90°-180° (for southeast-facing window)

# ==============================================================================
# Cron Job Setup Example
# ==============================================================================
# First, create a logs directory: mkdir -p ~/logs
#
# Then add to your crontab (crontab -e):
#
# Option 1: Specify .env file path explicitly (RECOMMENDED for cron)
# */15 * * * * nix run /Users/YOUR_USERNAME/path/to/awning#automation -- --env-file=/Users/YOUR_USERNAME/path/to/awning/.env >> ~/logs/awning-automation.log 2>&1
#
# Option 2: Change to project directory (auto-finds .env in current directory)
# */15 * * * * cd /Users/YOUR_USERNAME/path/to/awning && nix run .#automation >> ~/logs/awning-automation.log 2>&1
#
# The automation will only open the awning when ALL conditions are met.
# It checks the current awning state before taking action, so it won't
# repeatedly send open/close commands if the awning is already in the desired state.

# ==============================================================================
# Telegram Notifications (optional)
# ==============================================================================
# Get notifications when awning opens/closes or on errors
# Get bot token from @BotFather on Telegram
# Get chat ID by messaging @userinfobot (or use a group/channel ID)
# TELEGRAM_BOT_TOKEN=your_bot_token_here
# TELEGRAM_CHAT_ID=your_chat_id_here

# ==============================================================================
# Bond Bridge ID (optional, for mDNS discovery)
# ==============================================================================
# Used by deploy.sh to automatically discover Bond Bridge IP via mDNS
# Find in Bond Home app → Settings → Device Info (e.g., ZZIF27980)
# BOND_ID=your_bond_id_here

# ==============================================================================
# Logging Configuration (optional)
# ==============================================================================
# Logs are stored in ~/.config/awning/logs/ with daily rotation
# A symlink at ~/awning.log always points to today's log file

# Number of days to keep log files before automatic cleanup
# Default: 30 days
# LOG_RETENTION_DAYS=30
